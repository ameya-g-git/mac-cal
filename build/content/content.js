/*! For license information please see content.js.LICENSE.txt */
(()=>{"use strict";var e={931:(e,t,n)=>{n.d(t,{K:()=>o}),e=n.hmd(e);var r=r||function(e){if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,a=/constructor/i.test(e.HTMLElement)||e.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},l=function(e){setTimeout(function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()},4e4)},c=function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){s(e)}}},u=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},d=function(t,s,d){d||(t=u(t));var f,g=this,p="application/octet-stream"===t.type,y=function(){c(g,"writestart progress write writeend".split(" "))};if(g.readyState=g.INIT,o)return f=n().createObjectURL(t),void setTimeout(function(){r.href=f,r.download=s,function(e){var t=new MouseEvent("click");e.dispatchEvent(t)}(r),y(),l(f),g.readyState=g.DONE});!function(){if((i||p&&a)&&e.FileReader){var r=new FileReader;return r.onloadend=function(){var t=i?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,g.readyState=g.DONE,y()},r.readAsDataURL(t),void(g.readyState=g.INIT)}f||(f=n().createObjectURL(t)),p?e.location.href=f:e.open(f,"_blank")||(e.location.href=f),g.readyState=g.DONE,y(),l(f)}()},f=d.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=u(e)),navigator.msSaveOrOpenBlob(e,t)}:(f.abort=function(){},f.readyState=f.INIT=0,f.WRITING=1,f.DONE=2,f.error=f.onwritestart=f.onprogress=f.onwrite=f.onabort=f.onerror=f.onwriteend=null,function(e,t,n){return new d(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||(void 0).content);e.exports?e.exports.saveAs=r:"undefined"!=typeof define&&null!==define&&null!==n.amdO&&define("FileSaver.js",function(){return r});let o=function(e,t){if(!(navigator.userAgent.indexOf("MSIE")>-1&&-1==navigator.userAgent.indexOf("MSIE 10"))){void 0===e&&(e="default"),void 0===t&&(t="Calendar");var n=-1!==navigator.appVersion.indexOf("Win")?"\r\n":"\n",o=[],a=["BEGIN:VCALENDAR","PRODID:"+t,"VERSION:2.0"].join(n),i=n+"END:VCALENDAR",s=["SU","MO","TU","WE","TH","FR","SA"];return{events:function(){return o},calendar:function(){return a+n+o.join(n)+i},addEvent:function(t,r,a,i,l,c){if(void 0===t||void 0===r||void 0===a||void 0===i||void 0===l)return!1;if(c&&!c.rrule){if("YEARLY"!==c.freq&&"MONTHLY"!==c.freq&&"WEEKLY"!==c.freq&&"DAILY"!==c.freq)throw"Recurrence rrule frequency must be provided and be one of the following: 'YEARLY', 'MONTHLY', 'WEEKLY', or 'DAILY'";if(c.until&&isNaN(Date.parse(c.until)))throw"Recurrence rrule 'until' must be a valid date string";if(c.interval&&isNaN(parseInt(c.interval)))throw"Recurrence rrule 'interval' must be an integer";if(c.count&&isNaN(parseInt(c.count)))throw"Recurrence rrule 'count' must be an integer";if(void 0!==c.byday){if("[object Array]"!==Object.prototype.toString.call(c.byday))throw"Recurrence rrule 'byday' must be an array";if(c.byday.length>7)throw"Recurrence rrule 'byday' array must not be longer than the 7 days in a week";for(var u in c.byday=c.byday.filter(function(e,t){return c.byday.indexOf(e)==t}),c.byday)if(s.indexOf(c.byday[u])<0)throw"Recurrence rrule 'byday' values must include only the following: 'SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'"}}var d=new Date(i),f=new Date(l),g=new Date,p=("0000"+d.getFullYear().toString()).slice(-4),y=("00"+(d.getMonth()+1).toString()).slice(-2),m=("00"+d.getDate().toString()).slice(-2),D=("00"+d.getHours().toString()).slice(-2),h=("00"+d.getMinutes().toString()).slice(-2),S=("00"+d.getSeconds().toString()).slice(-2),w=("0000"+f.getFullYear().toString()).slice(-4),b=("00"+(f.getMonth()+1).toString()).slice(-2),v=("00"+f.getDate().toString()).slice(-2),E=("00"+f.getHours().toString()).slice(-2),T=("00"+f.getMinutes().toString()).slice(-2),A=("00"+f.getSeconds().toString()).slice(-2),N="",O="";D+h+S+E+T+A!=0&&(N="T"+D+h+S,O="T"+E+T+A);var I,R=p+y+m+N,x=w+b+v+O,L=("0000"+g.getFullYear().toString()).slice(-4)+("00"+(g.getMonth()+1).toString()).slice(-2)+("00"+g.getDate().toString()).slice(-2)+"T"+("00"+g.getHours().toString()).slice(-2)+("00"+g.getMinutes().toString()).slice(-2)+("00"+g.getSeconds().toString()).slice(-2);if(c)if(c.rrule)I=c.rrule;else{if(I="RRULE:FREQ="+c.freq,c.until){var M=new Date(Date.parse(c.until)).toISOString();I+=";UNTIL="+M.substring(0,M.length-13).replace(/[-]/g,"")+"000000Z"}c.interval&&(I+=";INTERVAL="+c.interval),c.count&&(I+=";COUNT="+c.count),c.byday&&c.byday.length>0&&(I+=";BYDAY="+c.byday.join(","))}(new Date).toISOString();var U=["BEGIN:VEVENT","UID:"+o.length+"@"+e,"CLASS:PUBLIC","DESCRIPTION:"+r,"DTSTAMP;VALUE=DATE-TIME:"+L,"DTSTART;VALUE=DATE-TIME:"+R,"DTEND;VALUE=DATE-TIME:"+x,"LOCATION:"+a,"SUMMARY;LANGUAGE=en-us:"+t,"TRANSP:TRANSPARENT","END:VEVENT"];return I&&U.splice(4,0,I),U=U.join(n),o.push(U),U},download:function(e,t){if(o.length<1)return!1;t=void 0!==t?t:".ics",e=void 0!==e?e:"calendar";var s,l=a+n+o.join(n)+i;if(-1===navigator.userAgent.indexOf("MSIE 10"))s=new Blob([l]);else{var c=new BlobBuilder;c.append(l),s=c.getBlob("text/x-vCalendar;charset="+document.characterSet)}return r(s,e+t),l},build:function(){return!(o.length<1)&&a+n+o.join(n)+i}}}console.log("Unsupported Browser")}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={id:r,loaded:!1,exports:{}};return e[r](a,a.exports,n),a.loaded=!0,a.exports}n.amdO={},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r=n(931);function o(e,t){const n=e.getDay();let r=0;switch(t){case"MO":r=1;break;case"TU":r=2;break;case"WE":r=3;break;case"TH":r=4;break;case"FR":r=5;break;case"SA":r=6}return r-n}function a(e,t){let n=-1;for(let r=0;r<t.length&&n<0;r++)n=o(e,t[r]);return n<0&&(n=7+o(e,t[0])),e.getDate()+n}function i(e,t){let n=[],r="",o=!1;const{name:a,classType:i,classSec:s,loc:l}=t;for(const t of e){if(o?r+=t:n.push(t),"{"===t){if(n.pop(),"\\"===n[n.length-1]){n.pop(),n.push("{");continue}o=!0}if("}"===t){if(o=!1,r=r.slice(0,-1),!r)continue;switch(r){case"code":n.push(a);break;case"type":n.push(i);break;case"sec":n.push(s);break;case"room":n.push(l);break;default:n.push(`{${r}}`)}r=""}}if(o)throw new SyntaxError("Curly brace not closed.");return n.join("")}function s(e,t){const n=function(){const e=document.querySelectorAll("#legend_box>.course_box .course_cell_legend");function t(e,t){const[n,r]=e.split(": ").map(e=>e.trim());let o,a;const i=n.split(", ").map(e=>e.toUpperCase());if(i.length!==n.split(" ").length){const e=i[i.length-1],[n,r]=[e.slice(0,3),e.slice(4)];i[i.length-1]=n,o=new Date(`${r.split(" - ")[0]} ${t}`),a=new Date(`${r.split(" - ")[1]} ${t}`)}const s=r.split(" to ");return{freq:{days:i.map(e=>e.slice(0,2)),startTime:s[0],endTime:s[1]},...o&&a&&{begin:o,end:a}}}function n(e){let t;return t=e.querySelector(".legend_multi_loc")?Array.from(e.querySelectorAll(".legend_multi_loc")).map(e=>e.textContent.split(" - ")[1].replace("_"," ")):[e.textContent.split(" - ")[1].replace("_"," ")],t}let r={sem:"",classes:[]};for(const o of e){const e=o.querySelector(".header_cell"),a=e.querySelector(".course_title"),[i,s]=a.nextElementSibling.textContent.split(": "),[l,c]=s.split(" - ").map(e=>new Date(`${e} ${i.split(" ")[0]}`));r.sem=i.toLowerCase().replace("/","");const u=o.querySelector(".inner_legend_table:has(.is-checked)"),d=Array.from(u.querySelectorAll("strong.type_block")).map(e=>e.textContent),f=Array.from(u.querySelectorAll(".location_block")).map(e=>n(e)),g=Array.from(u.querySelectorAll("[title*='Instructor']")).map(e=>e.textContent),p=e.querySelector("#hoursInLegend").innerHTML.split("<br>").slice(0,-1);let y=[p];2==d.length?y=[2==p.length?[p[0]]:p.slice(0,2),[p[p.length-1]]]:3==d.length&&(y=p.map(e=>[e])),y.forEach((e,n)=>{const[o,i]=d[n].split(" "),[s,u]=r.sem.split(" ");e.forEach((e,u)=>r.classes.push({begin:l,end:c,name:a.textContent,classType:o,classSec:i,prof:g[n],loc:f[n][u],...t(e,s)}))})}return r}(),{sem:o,classes:s}=n,[l,c]=o.split(" "),u=`maccal${o.replace(" ","")}`,d=(0,r.K)(u);let f;c.includes("fall")?f=function(e){const t=new Date(e,8,30);let n=[];return n.push(t),n.push(...function(e){const t=new Date(2025,9,1),n=t.getDay()>1?8-t.getDay():1-t.getDay(),r=new Date(e,9,1+n+7),o=[r];for(let e=1;e<=6;e++){const t=new Date(r);t.setDate(t.getDate()+e),o.push(t)}return o}(e)),n}(Number(l)):c.includes("summer")?f=function(e){let t=[];return t.push(function(e){const t=new Date(e,4,18),n=t.getDay()>1?8-t.getDay():1-t.getDay();return new Date(e,4,18+n)}(e)),t.push(new Date(e,6,1)),t.push(function(e){const t=new Date(e,7,1),n=t.getDay()>1?8-t.getDay():1-t.getDay();return new Date(e,7,1+n)}(e)),t}(Number(l)):c.includes("winter")&&(f=function(e){const t=function(e){const t=new Date(e,1,1),n=t.getDay()>1?8-t.getDay():1-t.getDay(),r=new Date(e,1,1+n+14),o=[r];for(let e=1;e<=6;e++){const t=new Date(r);t.setDate(t.getDate()+e),o.push(t)}return o}(e);return t.push(function(e){const t=new Date(2025,5,25,6,31),n=new Date(e,2,21),r=Math.abs(n-t)/864e5/29.53%1,o=29.53*(r>.5?1.5-r:.5-r),a=new Date(n);a.setDate(a.getDate()+o);const i=0==a.getDay?0:7-a.getDay();a.setDate(a.getDate()+i);const s=new Date(a);return s.setDate(s.getDate()-2),s}(e)),t}(Number(l)));for(const n of s){const{begin:r,end:o,name:s,classType:l,classSec:c,prof:u,loc:g,freq:p}=n;r.setDate(r.getDate()-1),o.setDate(o.getDate()+1);const y=[...f];y.push(r),y.push(o),y.sort((e,t)=>e.getTime()-t.getTime()),y.splice(0,y.findIndex(e=>e.getTime()===r.getTime()));for(let n=0;n<y.length-1;n++){const r=new Date(y[n]);r.setDate(r.getDate()+1);const u=new Date(y[n+1]);if(r.getTime()===u.getTime())continue;if(y[n].getTime()===o.getTime())break;const{days:f,startTime:m,endTime:D}=p;let h=`${s} - ${l} ${c}`;try{h=i(e,{name:s,classType:l,classSec:c,loc:g})}catch{console.error("Error in event name. Reverting to default name format."),h=`${s} - ${l} ${c}`}let S=new Date(r);S.setDate(a(S,f));const w={freq:"WEEKLY",byday:f,until:u};d.addEvent(h,"",t?g:"",`${S.toDateString()} ${m}`,`${S.toDateString()} ${D}`,w)}}d.download("maccal_"+o.replace(" ",""))}(()=>{let e="";function t(e,t,n){return e.nameFormat&&s(e.nameFormat,e.includeLoc),!0}window.location.href.match(/.*:\/\/mytimetable\.mcmaster\.ca.*/),browser.runtime.onMessage.hasListener(t)||browser.runtime.onMessage.addListener(t)})()})();
//# sourceMappingURL=content.js.map